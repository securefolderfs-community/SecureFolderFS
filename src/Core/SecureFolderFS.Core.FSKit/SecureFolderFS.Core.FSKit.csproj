<Project Sdk="Microsoft.NET.Sdk">
    <PropertyGroup>
        <TargetFramework>net10.0-macos</TargetFramework>
        <OutputType>Library</OutputType>
        <Nullable>enable</Nullable>
        <SupportedOSPlatformVersion>15.4</SupportedOSPlatformVersion>
        <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
        <RuntimeIdentifier>osx-arm64</RuntimeIdentifier>
        
        <!-- DNNE Configuration -->
        <EnableDynamicLoading>true</EnableDynamicLoading>
        <DnneNativeBinaryName>SecureFolderFS.Core.FSKit</DnneNativeBinaryName>
        <DnneAddGeneratedBinaryToProject>true</DnneAddGeneratedBinaryToProject>

        <!-- NativeAOT Configuration -->
<!--        <PublishAot>true</PublishAot>-->
<!--        <EnableLibraryAot>true</EnableLibraryAot>-->

        <!-- Create dylib instead of executable -->
<!--        <NativeLib>Shared</NativeLib>-->
<!--        <IncludeNativeLibrariesForSelfExtract>true</IncludeNativeLibrariesForSelfExtract>-->
<!--        <PublishTrimmed>false</PublishTrimmed>-->
<!--        <PublishReadyToRun>true</PublishReadyToRun>-->

        <!-- Trimming configuration for NativeAOT -->
<!--        <UseNativeHttpHandler>true</UseNativeHttpHandler>-->
<!--        <InvariantGlobalization>false</InvariantGlobalization>-->
<!--        <TrimMode>partial</TrimMode>-->
<!--        <IlcOptimizationPreference>Speed</IlcOptimizationPreference>-->
<!--        <IlcGenerateStackTraceData>false</IlcGenerateStackTraceData>-->
    </PropertyGroup>

    <ItemGroup>
        <None Include="Info.plist">
            <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>
        </None>
        <None Include="Entitlements.plist" />
    </ItemGroup>

    <ItemGroup>
        <!-- Exclude old app files - we're now a library -->
        <Compile Remove="Main.cs" />
        <Compile Remove="AppDelegate.cs" />
        <Compile Remove="ViewController.cs" />
        <Compile Remove="ViewController.designer.cs" />
        <None Remove="Main.storyboard" />
    </ItemGroup>

    <ItemGroup>
      <ProjectReference Include="..\..\Sdk\SecureFolderFS.Sdk.Ipc\SecureFolderFS.Sdk.Ipc.csproj" />
    </ItemGroup>

    <ItemGroup>
      <PackageReference Include="DNNE" Version="2.0.8" />
    </ItemGroup>
</Project>
