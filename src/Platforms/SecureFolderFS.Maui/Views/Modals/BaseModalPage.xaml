<ContentPage
    x:Class="SecureFolderFS.Maui.Views.Modals.BaseModalPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:local="clr-namespace:SecureFolderFS.Maui.Views.Modals"
    xmlns:mdc="clr-namespace:Material.Components.Maui;assembly=Material.Components.Maui"
    xmlns:vc="clr-namespace:SecureFolderFS.Maui.ValueConverters"
    x:Name="Root"
    x:DataType="local:BaseModalPage"
    BackgroundColor="Transparent"
    NavigationPage.HasNavigationBar="False"
    Shell.NavBarIsVisible="False">

    <ContentPage.Resources>
        <vc:NullToBoolConverter x:Key="NullToBoolConverter" />
    </ContentPage.Resources>

    <NavigationPage.HasNavigationBar>
        <OnPlatform x:TypeArguments="x:Boolean">
            <On Platform="Android" Value="False" />
            <On Platform="iOS" Value="True" />
        </OnPlatform>
    </NavigationPage.HasNavigationBar>

    <NavigationPage.TitleView>
        <OnPlatform x:TypeArguments="View">
            <On Platform="iOS">
                <Grid>
                    <Label
                        FontAttributes="Bold"
                        FontSize="18"
                        HorizontalOptions="Center"
                        Text="{Binding Title, Mode=OneWay}"
                        VerticalOptions="Center" />

                    <Button
                        Command="{Binding PrimaryCommand, Mode=OneWay}"
                        FontAttributes="Bold"
                        FontSize="18"
                        HorizontalOptions="End"
                        IsEnabled="{Binding PrimaryEnabled, Mode=OneWay}"
                        IsVisible="{Binding PrimaryText, Mode=OneWay, Converter={StaticResource NullToBoolConverter}}"
                        Text="{Binding PrimaryText, Mode=OneWay}"
                        VerticalOptions="Center" />
                </Grid>
            </On>
        </OnPlatform>
    </NavigationPage.TitleView>

    <OnPlatform x:TypeArguments="View">
        <On Platform="Android">
            <Border BackgroundColor="White" BindingContext="{x:Reference Root}">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="24,24,0,0" />
                </Border.StrokeShape>

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <Label
                        Grid.Row="0"
                        Padding="16"
                        FontAttributes="Bold"
                        FontSize="22"
                        Text="{Binding Title, Mode=OneWay}" />

                    <ContentView
                        Grid.Row="1"
                        Content="{Binding ModalContent, Mode=OneWay}"
                        HorizontalOptions="Fill"
                        VerticalOptions="Fill" />

                    <!--  Buttons  -->
                    <Grid
                        Grid.Row="2"
                        Padding="8"
                        ColumnSpacing="8"
                        HorizontalOptions="Fill">

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <mdc:Button
                            Grid.Column="0"
                            Command="{Binding CloseCommand, Mode=OneWay}"
                            HorizontalOptions="Fill"
                            IsEnabled="{Binding CloseEnabled, Mode=OneWay}"
                            IsVisible="{Binding CloseText, Mode=OneWay, Converter={StaticResource NullToBoolConverter}}"
                            Style="{DynamicResource FilledTonalButtonStyle}"
                            Text="{Binding CloseText, Mode=OneWay}" />

                        <mdc:Button
                            Grid.Column="1"
                            Command="{Binding PrimaryCommand, Mode=OneWay}"
                            HorizontalOptions="Fill"
                            IsEnabled="{Binding PrimaryEnabled, Mode=OneWay}"
                            IsVisible="{Binding PrimaryText, Mode=OneWay, Converter={StaticResource NullToBoolConverter}}"
                            Text="{Binding PrimaryText, Mode=OneWay}" />
                    </Grid>
                </Grid>
            </Border>
        </On>
        <On Platform="iOS">
            <Border BackgroundColor="White" BindingContext="{x:Reference Root}">
                <ContentView
                    Content="{Binding ModalContent, Mode=OneWay}"
                    HorizontalOptions="Fill"
                    VerticalOptions="Fill" />
            </Border>
        </On>
    </OnPlatform>
</ContentPage>
