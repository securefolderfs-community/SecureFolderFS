<ContentPage
    x:Class="SecureFolderFS.Maui.Views.Modals.BaseModalPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:local="clr-namespace:SecureFolderFS.Maui.Views.Modals"
    xmlns:mdc="clr-namespace:Material.Components.Maui;assembly=Material.Components.Maui"
    xmlns:vc="clr-namespace:SecureFolderFS.Maui.ValueConverters"
    x:Name="Root"
    x:DataType="local:BaseModalPage"
    BackgroundColor="Transparent"
    NavigationPage.HasNavigationBar="False"
    Shell.NavBarIsVisible="False">

    <ContentPage.Resources>
        <vc:NullToBoolConverter x:Key="NullToBoolConverter" />
    </ContentPage.Resources>

    <Border BackgroundColor="White" BindingContext="{x:Reference Root}">
        <Border.StrokeShape>
            <RoundRectangle CornerRadius="24,24,0,0" />
        </Border.StrokeShape>

        <OnPlatform x:TypeArguments="View">
            <On Platform="Android">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <Label
                        Grid.Row="0"
                        Padding="16"
                        FontAttributes="Bold"
                        FontSize="24"
                        Text="{Binding Title, Mode=OneWay}" />

                    <ContentView
                        Grid.Row="1"
                        Content="{Binding ModalContent, Mode=OneWay}"
                        HorizontalOptions="Fill"
                        VerticalOptions="Fill" />

                    <Grid
                        Grid.Row="2"
                        Padding="8"
                        ColumnSpacing="8"
                        HorizontalOptions="Fill">

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>

                        <mdc:Button
                            Grid.Column="0"
                            Command="{Binding CloseCommand, Mode=OneWay}"
                            HorizontalOptions="Fill"
                            IsEnabled="True"
                            IsVisible="{Binding CloseText, Mode=OneWay, Converter={StaticResource NullToBoolConverter}}"
                            Style="{DynamicResource FilledTonalButtonStyle}"
                            Text="{Binding CloseText, Mode=OneWay}" />

                        <mdc:Button
                            Grid.Column="1"
                            Command="{Binding PrimaryCommand, Mode=OneWay}"
                            HorizontalOptions="Fill"
                            IsEnabled="{Binding PrimaryEnabled, Mode=OneWay}"
                            IsVisible="{Binding PrimaryText, Mode=OneWay, Converter={StaticResource NullToBoolConverter}}"
                            Text="{Binding PrimaryText, Mode=OneWay}" />
                    </Grid>
                </Grid>
            </On>
            <On Platform="iOS">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition />
                    </Grid.RowDefinitions>

                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <Button
                            Grid.Column="0"
                            Command="{Binding CloseCommand, Mode=OneWay}"
                            HorizontalOptions="Fill"
                            IsEnabled="True"
                            IsVisible="{Binding CloseText, Mode=OneWay, Converter={StaticResource NullToBoolConverter}}"
                            Text="{Binding CloseText, Mode=OneWay}"
                            VerticalOptions="End" />

                        <Label
                            Grid.Column="1"
                            Padding="16"
                            FontAttributes="Bold"
                            FontSize="24"
                            HorizontalOptions="Center"
                            Text="{Binding Title, Mode=OneWay}" />

                        <Button
                            Grid.Column="2"
                            Command="{Binding PrimaryCommand, Mode=OneWay}"
                            HorizontalOptions="Fill"
                            IsEnabled="{Binding PrimaryEnabled, Mode=OneWay}"
                            IsVisible="{Binding PrimaryText, Mode=OneWay, Converter={StaticResource NullToBoolConverter}}"
                            Text="{Binding PrimaryText, Mode=OneWay}"
                            VerticalOptions="End" />
                    </Grid>

                    <ContentView
                        Grid.Row="1"
                        Content="{Binding ModalContent, Mode=OneWay}"
                        HorizontalOptions="Fill"
                        VerticalOptions="Fill" />
                </Grid>
            </On>
        </OnPlatform>
    </Border>
</ContentPage>
